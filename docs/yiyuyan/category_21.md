# 🛰️ VNC(HDVNC)
## 📌 函数: HDVNC_连接虚拟机
### 描述
```
连接虚拟机
```
### 原型
```
__int64 __stdcall HCVnc_Connect(__int32 windowsIndex,__int32 port);
```
### 参数
```
 窗口序号 - 窗口序号每个窗口序号可以绑定一个虚拟机VNC端口注意
__int32 port - 虚拟机开启VNC设置的端口
```
### 返回值
```
查看返回值表
```
### 注意事项
```
对应的虚拟机请开启VNC并设置好端口
两种使用VNC模式特别注意:
1.安装插件(HDEX_InstallPluginVM)的形式连接VNC:支持重连port==0属于重连会检查安装插件时候的PID同时自动获取之前连接过的端口前提是已经连接过卸载的时候内部调用(HCEnv_UnLoadEx)
2.未安装插件(HCVnc_Connect)的形式连接VNC:重连一直都可以不能port==0因为会检查PID未安装插件的PID为0卸载的时候内部调用(HCEnv_UnLoad)
```
### HDVNC_连接虚拟机 - 进阶用法
```
.版本 2
.子程序 示例2
    调试输出("示例2")
```
### HDVNC_连接虚拟机 - 高级应用
```
.版本 2
.子程序 高级示例
    调试输出("高级示例")
```

---
## 📌 函数: HDVNC_关闭连接
### 描述
```
关闭连接虚拟机
```
### 原型
```
__int64 __stdcall HCVnc_Close(__int32 windowsIndex);
```
### 参数
```
 窗口序号 - 窗口序号每个窗口序号可以绑定一个虚拟机VNC端口
```
### 返回值
```
查看返回值表
```
### 注意事项
```
对应的虚拟机请开启VNC并设置好端口
两种使用VNC模式特别注意:
1.安装插件(HDEX_InstallPluginVM)的形式连接VNC:支持重连port==0属于重连会检查安装插件时候的PID同时自动获取之前连接过的端口前提是已经连接过卸载的时候内部调用(HCEnv_UnLoadEx)
2.未安装插件(HCVnc_Connect)的形式连接VNC:重连一直都可以不能port==0因为会检查PID未安装插件的PID为0卸载的时候内部调用(HCEnv_UnLoad)
```
### HDVNC_关闭连接 - 基础示例
```
.版本 2

.子程序 测试关闭VNC连接, 逻辑型, 公开
    .局部变量 窗口序号, 整数型
    .局部变量 结果, 逻辑型
    
    窗口序号 ＝ 1
    
    调试输出 ("准备关闭VNC连接")
    调试输出 ("窗口序号：", 窗口序号)
    
    ' 关闭VNC连接
    结果 ＝ HDVNC_关闭 (窗口序号)
    .如果 (结果 ＝ 真)
        调试输出 ("VNC连接已关闭")
    .否则
        调试输出 ("关闭VNC连接失败")
    .如果结束
    
    返回 (结果)
```
### HDVNC_关闭连接 - 进阶用法
```
.版本 2
.子程序 示例2
    调试输出("示例2")
```
### HDVNC_关闭连接 - 高级应用
```
.版本 2
.子程序 高级示例
    调试输出("高级示例")
```

---
## 📌 函数: HDVNC_鼠标绝对移动
### 描述
```
VNC鼠标绝对移动(自带移动轨迹直线波动防检测)
```
### 原型
```
__int64 __stdcall HCVnc_MoveTo(__int32 windowsIndex,__int32 x,__int32 y);
```
### 参数
```
 窗口序号 - 窗口序号每个窗口序号可以绑定一个虚拟机VNC端口
__int32 x - 虚拟机屏幕坐标X
__int32 y - 虚拟机屏幕坐标Y
```
### 返回值
```
查看返回值表
```
### 注意事项
```
无
```
### HDVNC_鼠标绝对移动 - 进阶用法
```
.版本 2
.子程序 示例2
    调试输出("示例2")
```
### HDVNC_鼠标绝对移动 - 高级应用
```
.版本 2
.子程序 高级示例
    调试输出("高级示例")
```

---
## 📌 函数: HDVNC_鼠标相对移动
### 描述
```
VNC鼠标相对移动(自带移动轨迹直线波动防检测)
```
### 原型
```
__int64 __stdcall HCVnc_MoveToOffset(__int32 windowsIndex,__int32 x,__int32 y);
```
### 参数
```
 窗口序号 - 窗口序号每个窗口序号可以绑定一个虚拟机VNC端口
__int32 x - 虚拟机屏幕相对坐标X
__int32 y - 虚拟机屏幕相对坐标X
```
### 返回值
```
查看返回值表
```
### 注意事项
```
无
```
### HDVNC_鼠标相对移动 - 基础示例
```
.版本 2

.子程序 测试VNC鼠标移动, 逻辑型, 公开
    .局部变量 窗口序号, 整数型
    .局部变量 目标X, 整数型
    .局部变量 目标Y, 整数型
    .局部变量 结果, 逻辑型
    
    ' 设置移动参数
    窗口序号 ＝ 1
    目标X ＝ 400
    目标Y ＝ 300
    
    调试输出 ("准备VNC鼠标移动")
    调试输出 ("目标坐标：(", 目标X, ",", 目标Y, ")")
    
    ' 执行VNC鼠标移动
    结果 ＝ HDVNC_移动 (窗口序号, 目标X, 目标Y)
    .如果 (结果 ＝ 真)
        调试输出 ("VNC鼠标移动成功")
        调试输出 ("已带有防检测轨迹")
    .否则
        调试输出 ("VNC鼠标移动失败")
    .如果结束
    
    返回 (结果)
```
### HDVNC_鼠标相对移动 - 进阶用法
```
.版本 2
.子程序 示例2
    调试输出("示例2")
```
### HDVNC_鼠标相对移动 - 高级应用
```
.版本 2
.子程序 高级示例
    调试输出("高级示例")
```

---
## 📌 函数: HDVNC_鼠标左键点击
### 描述
```
VNC鼠标左键点击
```
### 原型
```
__int64 __stdcall HCVnc_LeftClick(__int32 windowsIndex);
```
### 参数
```
 窗口序号 - 窗口序号每个窗口序号可以绑定一个虚拟机VNC端口
```
### 返回值
```
查看返回值表
```
### 注意事项
```
无
```
### HDVNC_鼠标左键点击 - 基础示例
```
.版本 2

.子程序 测试VNC右键点击, 逻辑型, 公开
    .局部变量 窗口序号, 整数型
    .局部变量 结果, 逻辑型
    
    窗口序号 ＝ 1
    
    调试输出 ("准备执行VNC右键点击")
    
    ' 执行VNC右键点击
    结果 ＝ HDVNC_右键点击 (窗口序号)
    .如果 (结果 ＝ 真)
        调试输出 ("VNC右键点击成功")
        调试输出 ("可能会显示右键菜单")
    .否则
        调试输出 ("VNC右键点击失败")
    .如果结束
    
    返回 (结果)
```
### HDVNC_鼠标左键点击 - 进阶用法
```
.版本 2
.子程序 示例2
    调试输出("示例2")
```
### HDVNC_鼠标左键点击 - 高级应用
```
.版本 2
.子程序 高级示例
    调试输出("高级示例")
```

---
## 📌 函数: HDVNC_鼠标左键按下
### 描述
```
VNC鼠标左键按下
```
### 原型
```
__int64 __stdcall HCVnc_LeftDown(__int32 windowsIndex);
```
### 参数
```
 窗口序号 - 窗口序号每个窗口序号可以绑定一个虚拟机VNC端口
```
### 返回值
```
查看返回值表
```
### 注意事项
```
无
```
### HDVNC_鼠标左键按下 - 进阶用法
```
.版本 2
.子程序 示例2
    调试输出("示例2")
```
### HDVNC_鼠标左键按下 - 高级应用
```
.版本 2
.子程序 高级示例
    调试输出("高级示例")
```

---
## 📌 函数: HDVNC_鼠标左键弹起
### 描述
```
VNC鼠标左键弹起
```
### 原型
```
__int64 __stdcall HCVnc_LeftUp(__int32 windowsIndex);
```
### 参数
```
 窗口序号 - 窗口序号每个窗口序号可以绑定一个虚拟机VNC端口
```
### 返回值
```
查看返回值表
```
### 注意事项
```
无
```
### HDVNC_鼠标左键弹起 - 进阶用法
```
.版本 2
.子程序 示例2
    调试输出("示例2")
```
### HDVNC_鼠标左键弹起 - 高级应用
```
.版本 2
.子程序 高级示例
    调试输出("高级示例")
```

---
## 📌 函数: HDVNC_鼠标左键双击
### 描述
```
VNC鼠标左键双击
```
### 原型
```
__int64 __stdcall HCVnc_LeftDoubleClick(__int32 windowsIndex);
```
### 参数
```
 窗口序号 - 窗口序号每个窗口序号可以绑定一个虚拟机VNC端口
```
### 返回值
```
查看返回值表
```
### 注意事项
```
无
```
### HDVNC_鼠标左键双击 - 基础示例
```
.版本 2

.子程序 测试VNC左键双击, 逻辑型, 公开
    .局部变量 窗口序号, 整数型
    .局部变量 结果, 逻辑型
    
    窗口序号 ＝ 1
    
    调试输出 ("准备执行VNC左键双击")
    
    ' 执行VNC左键双击
    结果 ＝ HDVNC_左键双击 (窗口序号)
    .如果 (结果 ＝ 真)
        调试输出 ("VNC左键双击成功")
    .否则
        调试输出 ("VNC左键双击失败")
    .如果结束
    
    返回 (结果)
```
### HDVNC_鼠标左键双击 - 进阶用法
```
.版本 2
.子程序 示例2
    调试输出("示例2")
```
### HDVNC_鼠标左键双击 - 高级应用
```
.版本 2
.子程序 高级示例
    调试输出("高级示例")
```

---
## 📌 函数: HDVNC_鼠标右键点击
### 描述
```
VNC鼠标右键点击
```
### 原型
```
__int64 __stdcall HCVnc_RightClick(__int32 windowsIndex);
```
### 参数
```
 窗口序号 - 窗口序号每个窗口序号可以绑定一个虚拟机VNC端口
```
### 返回值
```
查看返回值表
```
### 注意事项
```
无
```
### HDVNC_鼠标右键点击 - 进阶用法
```
.版本 2
.子程序 示例2
    调试输出("示例2")
```
### HDVNC_鼠标右键点击 - 高级应用
```
.版本 2
.子程序 高级示例
    调试输出("高级示例")
```

---
## 📌 函数: HDVNC_鼠标右键按下
### 描述
```
VNC鼠标右键按下
```
### 原型
```
__int64 __stdcall HCVnc_RightDown(__int32 windowsIndex);
```
### 参数
```
 窗口序号 - 窗口序号每个窗口序号可以绑定一个虚拟机VNC端口
```
### 返回值
```
查看返回值表
```
### 注意事项
```
无
```
### HDVNC_鼠标右键按下 - 进阶用法
```
.版本 2
.子程序 示例2
    调试输出("示例2")
```
### HDVNC_鼠标右键按下 - 高级应用
```
.版本 2
.子程序 高级示例
    调试输出("高级示例")
```

---
## 📌 函数: HDVNC_鼠标右键弹起
### 描述
```
VNC鼠标右键弹起
```
### 原型
```
__int64 __stdcall HCVnc_RightUp(__int32 windowsIndex);
```
### 参数
```
 窗口序号 - 窗口序号每个窗口序号可以绑定一个虚拟机VNC端口
```
### 返回值
```
查看返回值表
```
### 注意事项
```
无
```
### HDVNC_鼠标右键弹起 - 基础示例
```
.版本 2

.子程序 测试VNC右键弹起, 逻辑型, 公开
    .局部变量 窗口序号, 整数型
    .局部变量 结果, 逻辑型
    
    窗口序号 ＝ 1
    
    调试输出 ("准备执行VNC右键弹起")
    
    ' 执行VNC右键弹起
    结果 ＝ HDVNC_右键弹起 (窗口序号)
    .如果 (结果 ＝ 真)
        调试输出 ("VNC右键弹起成功")
    .否则
        调试输出 ("VNC右键弹起失败")
    .如果结束
    
    返回 (结果)
```
### HDVNC_鼠标右键弹起 - 进阶用法
```
.版本 2
.子程序 示例2
    调试输出("示例2")
```
### HDVNC_鼠标右键弹起 - 高级应用
```
.版本 2
.子程序 高级示例
    调试输出("高级示例")
```

---
## 📌 函数: HDVNC_鼠标滚轮滚下
### 描述
```
VNC鼠标滚轮滚下
```
### 原型
```
__int64 __stdcall HCVnc_WheelDown(__int32 windowsIndex);
```
### 参数
```
 窗口序号 - 窗口序号每个窗口序号可以绑定一个虚拟机VNC端口
```
### 返回值
```
查看返回值表
```
### 注意事项
```
无
```
### HDVNC_鼠标滚轮滚下 - 进阶用法
```
.版本 2
.子程序 示例2
    调试输出("示例2")
```
### HDVNC_鼠标滚轮滚下 - 高级应用
```
.版本 2
.子程序 高级示例
    调试输出("高级示例")
```

---
## 📌 函数: HDVNC_鼠标滚轮滚上
### 描述
```
VNC鼠标滚轮滚上
```
### 原型
```
__int64 __stdcall HCVnc_WheelUp(__int32 windowsIndex);
```
### 参数
```
 窗口序号 - 窗口序号每个窗口序号可以绑定一个虚拟机VNC端口
```
### 返回值
```
查看返回值表
```
### 注意事项
```
无
```
### HDVNC_鼠标滚轮滚上 - 基础示例
```
.版本 2

.子程序 测试VNC滚轮向上, 逻辑型, 公开
    .局部变量 窗口序号, 整数型
    .局部变量 结果, 逻辑型
    
    窗口序号 ＝ 1
    
    调试输出 ("准备执行VNC滚轮向上滚动")
    
    ' 执行VNC滚轮向上滚动
    结果 ＝ HDVNC_滚轮滚上 (窗口序号)
    .如果 (结果 ＝ 真)
        调试输出 ("VNC滚轮向上滚动成功")
    .否则
        调试输出 ("VNC滚轮向上滚动失败")
    .如果结束
    
    返回 (结果)
```
### HDVNC_鼠标滚轮滚上 - 进阶用法
```
.版本 2
.子程序 示例2
    调试输出("示例2")
```
### HDVNC_鼠标滚轮滚上 - 高级应用
```
.版本 2
.子程序 高级示例
    调试输出("高级示例")
```

---
## 📌 函数: HCVnc_KeyPress
### 描述
```
VNC键盘按键敲击
```
### 原型
```
__int64 __stdcall HCVnc_KeyPress(__int32 windowsIndex,int keycode,BOOL isKeypad=false);
```
### 参数
```
 窗口序号 - 窗口序号每个窗口序号可以绑定一个虚拟机VNC端口
int keycode - VK键值
bool isKeypad - 是否数字小键盘一般假
```
### 返回值
```
查看返回值表
```
### 注意事项
```
无
```
### HCVnc_KeyPress - 进阶用法
```
.版本 2
.子程序 示例2
    调试输出("示例2")
```
### HCVnc_KeyPress - 高级应用
```
.版本 2
.子程序 高级示例
    调试输出("高级示例")
```

---
## 📌 函数: HDVNC_键盘按键按下
### 描述
```
VNC键盘按键按下
```
### 原型
```
__int64 __stdcall HCVnc_KeyDown(__int32 windowsIndex,int keycode);
```
### 参数
```
 窗口序号 - 窗口序号每个窗口序号可以绑定一个虚拟机VNC端口
int keycode - VK键值
```
### 返回值
```
查看返回值表
```
### 注意事项
```
无
```
### HDVNC_键盘按键按下 - 基础示例
```
.版本 2

.子程序 测试VNC按键按下, 逻辑型, 公开
    .局部变量 窗口序号, 整数型
    .局部变量 虚拟键码, 整数型
    .局部变量 结果, 逻辑型
    
    ' 设置按键参数
    窗口序号 ＝ 1
    虚拟键码 ＝ 16        ' Shift键
    
    调试输出 ("准备执行VNC按键按下")
    调试输出 ("虚拟键码：", 虚拟键码, " (Shift键)")
    
    ' 执行VNC按键按下
    结果 ＝ HDVNC_按键按下 (窗口序号, 虚拟键码)
    .如果 (结果 ＝ 真)
        调试输出 ("VNC按键按下成功")
        调试输出 ("可进行组合键操作")
    .否则
        调试输出 ("VNC按键按下失败")
    .如果结束
    
    返回 (结果)
```
### HDVNC_键盘按键按下 - 进阶用法
```
.版本 2
.子程序 示例2
    调试输出("示例2")
```
### HDVNC_键盘按键按下 - 高级应用
```
.版本 2
.子程序 高级示例
    调试输出("高级示例")
```

---
## 📌 函数: HDVNC_键盘按键弹起
### 描述
```
VNC键盘按键弹起
```
### 原型
```
__int64 __stdcall HCVnc_KeyUp(__int32 windowsIndex,int keycode);
```
### 参数
```
 窗口序号 - 窗口序号每个窗口序号可以绑定一个虚拟机VNC端口
int keycode - VK键值
```
### 返回值
```
查看返回值表
```
### 注意事项
```
无
```
### HDVNC_键盘按键弹起 - 基础示例
```
.版本 2

.子程序 测试VNC按键弹起, 逻辑型, 公开
    .局部变量 窗口序号, 整数型
    .局部变量 虚拟键码, 整数型
    .局部变量 结果, 逻辑型
    
    ' 设置按键参数
    窗口序号 ＝ 1
    虚拟键码 ＝ 16        ' Shift键
    
    调试输出 ("准备执行VNC按键弹起")
    调试输出 ("虚拟键码：", 虚拟键码, " (Shift键)")
    
    ' 执行VNC按键弹起
    结果 ＝ HDVNC_按键弹起 (窗口序号, 虚拟键码)
    .如果 (结果 ＝ 真)
        调试输出 ("VNC按键弹起成功")
        调试输出 ("组合键操作完成")
    .否则
        调试输出 ("VNC按键弹起失败")
    .如果结束
    
    返回 (结果)
```
### HDVNC_键盘按键弹起 - 进阶用法
```
.版本 2
.子程序 示例2
    调试输出("示例2")
```
### HDVNC_键盘按键弹起 - 高级应用
```
.版本 2
.子程序 高级示例
    调试输出("高级示例")
```

---
## 📌 函数: HCVnc_KeyPressStr
### 描述
```
VNC键盘连续按键字符串(数字+字母)
```
### 原型
```
__int64 __stdcall HCVnc_KeyPressStr(__int32 windowsIndex,char* strText,BOOL isKeypad=false);
```
### 参数
```
 窗口序号 - 窗口序号每个窗口序号可以绑定一个虚拟机VNC端口
char* strText - 字符串(ascii编码)如
bool isKeypad - 是否数字小键盘一般假
```
### 返回值
```
查看返回值表
```
### 注意事项
```
无
```
### HCVnc_KeyPressStr - 基础示例
```
.版本 2

.子程序 测试VNC按键敲击, 逻辑型, 公开
    .局部变量 窗口序号, 整数型
    .局部变量 虚拟键码, 整数型
    .局部变量 是否小键盘, 逻辑型
    .局部变量 结果, 逻辑型
    
    ' 设置按键参数
    窗口序号 ＝ 1
    虚拟键码 ＝ 13        ' 回车键
    是否小键盘 ＝ 假      ' 非小键盘按键
    
    调试输出 ("准备执行VNC按键敲击")
    调试输出 ("虚拟键码：", 虚拟键码, " (回车键)")
    调试输出 ("是否小键盘：", .如果真 (是否小键盘, "是", "否"))
    
    ' 执行VNC按键敲击
    结果 ＝ HDVNC_按键敲击 (窗口序号, 虚拟键码, 是否小键盘)
    .如果 (结果 ＝ 真)
        调试输出 ("VNC按键敲击成功")
    .否则
        调试输出 ("VNC按键敲击失败")
    .如果结束
    
    返回 (结果)
```
### HCVnc_KeyPressStr - 进阶用法
```
.版本 2
.子程序 示例2
    调试输出("示例2")
```
### HCVnc_KeyPressStr - 高级应用
```
.版本 2
.子程序 高级示例
    调试输出("高级示例")
```

---
## 📌 函数: HCVnc_SendString
### 描述
```
VNC键盘输入字符串(中文+数字+符号+字母)
```
### 原型
```
__int64 __stdcall HCVnc_SendString(__int32 windowsIndex,char* strText);
```
### 参数
```
 窗口序号 - 窗口序号每个窗口序号可以绑定一个虚拟机VNC端口
char* strText - 字符串(ascii编码)如
```
### 返回值
```
查看返回值表
```
### 注意事项
```
无
```
### HCVnc_SendString - 基础示例
```
.版本 2

.子程序 测试VNC输入字符串, 逻辑型, 公开
    .局部变量 窗口序号, 整数型
    .局部变量 输入文本, 文本型
    .局部变量 是否小键盘, 逻辑型
    .局部变量 结果, 逻辑型
    
    ' 设置输入参数
    窗口序号 ＝ 1
    输入文本 ＝ "Hello123!@#"
    是否小键盘 ＝ 假
    
    调试输出 ("准备VNC输入字符串")
    调试输出 ("输入内容：", 输入文本)
    
    ' 执行VNC输入字符串
    结果 ＝ HDVNC_按键字符串 (窗口序号, 输入文本, 是否小键盘)
    .如果 (结果 ＝ 真)
        调试输出 ("VNC字符串输入成功")
        调试输出 ("支持数字、字母和符号")
    .否则
        调试输出 ("VNC字符串输入失败")
    .如果结束
    
    返回 (结果)
```
### HCVnc_SendString - 进阶用法
```
.版本 2
.子程序 示例2
    调试输出("示例2")
```
### HCVnc_SendString - 高级应用
```
.版本 2
.子程序 高级示例
    调试输出("高级示例")
```

---
## 📌 函数: HDVNC_开启截图
### 描述
```
开启截图(内部会开启一根线程循环获取虚拟机画面)
```
### 原型
```
__int64 __stdcall HCVnc_OpenCapture(__int32 windowsIndex);
```
### 参数
```
 窗口序号 - 窗口序号每个窗口序号可以绑定一个虚拟机VNC端口
```
### 返回值
```
查看返回值表
```
### 注意事项
```
可以调用HCVnc_CloseCapture来结束截图线程
```
### HDVNC_开启截图 - 进阶用法
```
.版本 2
.子程序 示例2
    调试输出("示例2")
```
### HDVNC_开启截图 - 高级应用
```
.版本 2
.子程序 高级示例
    调试输出("高级示例")
```

---
## 📌 函数: HDVNC_关闭截图
### 描述
```
关闭截图(结束开启截图内部产生的线程)
```
### 原型
```
__int64 __stdcall HCVnc_CloseCapture(__int32 windowsIndex);
```
### 参数
```
 窗口序号 - 窗口序号每个窗口序号可以绑定一个虚拟机VNC端口
```
### 返回值
```
查看返回值表
```
### 注意事项
```
需要多次调用关闭,直到关闭成功,通常情况一次就能关闭成功
```
### HDVNC_关闭截图 - 进阶用法
```
.版本 2
.子程序 示例2
    调试输出("示例2")
```
### HDVNC_关闭截图 - 高级应用
```
.版本 2
.子程序 高级示例
    调试输出("高级示例")
```

---
